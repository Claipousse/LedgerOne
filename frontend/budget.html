<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LedgerOne - Gestion du Budget</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- SIDEBAR -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h1 class="sidebar-logo">LedgerOne</h1>
        </div>
        
        <nav class="sidebar-nav">
            <a href="index.html" class="sidebar-link">
                <span class="sidebar-icon">üìä</span>
                <span>Dashboard</span>
            </a>
            <a href="categories.html" class="sidebar-link">
                <span class="sidebar-icon">üè∑Ô∏è</span>
                <span>Cat√©gories</span>
            </a>
            <a href="transactions.html" class="sidebar-link">
                <span class="sidebar-icon">üìù</span>
                <span>Transactions</span>
            </a>
            <a href="import.html" class="sidebar-link">
                <span class="sidebar-icon">üì•</span>
                <span>Importation</span>
            </a>
            <a href="budget.html" class="sidebar-link active">
                <span class="sidebar-icon">üí∞</span>
                <span>Budget</span>
            </a>
        </nav>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="main-content">
        <!-- Header -->
        <header class="page-header">
            <div>
                <h1 class="page-title">Gestion du Budget</h1>
                <p class="page-subtitle">Suivez et analysez votre budget mensuel global</p>
            </div>
        </header>

        <!-- Alertes du mois -->
        <section id="alerts-section" class="hidden" style="margin-bottom: 2rem;">
            <!-- Alertes g√©n√©r√©es dynamiquement -->
        </section>

        <!-- Budget Global -->
        <section class="top5-section" style="margin-bottom: 2rem;">
            <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 2rem;">
                <div>
                    <h3 class="section-title">Budget Mensuel Global</h3>
                    <p class="section-subtitle">D√©finissez votre budget global pour le mois</p>
                </div>
                <button class="btn-primary" onclick="showEditGlobalBudget()">
                    <span>‚úèÔ∏è</span>
                    <span>Modifier</span>
                </button>
            </div>

            <!-- KPI Budget Global -->
            <div class="kpi-section" style="margin-bottom: 2rem;">
                <div class="kpi-card">
                    <div class="kpi-icon">üí∞</div>
                    <div class="kpi-content">
                        <p class="kpi-label">Budget mensuel global</p>
                        <h2 class="kpi-value" id="global-budget-value">-</h2>
                    </div>
                </div>

                <div class="kpi-card">
                    <div class="kpi-icon">üí≥</div>
                    <div class="kpi-content">
                        <p class="kpi-label">D√©penses actuelles</p>
                        <h2 class="kpi-value" id="global-spent-value">-</h2>
                    </div>
                </div>

                <div class="kpi-card">
                    <div class="kpi-icon">üéØ</div>
                    <div class="kpi-content">
                        <p class="kpi-label">Budget restant</p>
                        <h2 class="kpi-value" id="global-remaining-value">-</h2>
                    </div>
                </div>

                <div class="kpi-card">
                    <div class="kpi-icon">üìà</div>
                    <div class="kpi-content">
                        <p class="kpi-label">Projection fin de mois</p>
                        <h2 class="kpi-value" id="global-projection-value">-</h2>
                    </div>
                </div>
            </div>

            <!-- Barre de progression globale -->
            <div class="budget-progress-container">
                <div class="budget-progress-header">
                    <span class="budget-progress-label">Progression du budget global</span>
                    <span class="budget-progress-percentage" id="global-progress-percentage">0%</span>
                </div>
                <div class="budget-progress-bar">
                    <div class="budget-progress-fill" id="global-progress-fill" style="width: 0%;"></div>
                </div>
                <div class="budget-progress-info">
                    <span id="budget-days-info">Jour 0/30</span>
                    <span id="budget-pace-info">-</span>
                </div>
            </div>
        </section>

        <!-- Formulaire modification budget global (cach√© par d√©faut) -->
        <div class="category-form-container hidden" id="global-budget-form-container">
            <div class="category-form-card">
                <h3 class="form-title">Modifier le budget mensuel global</h3>
                <form id="global-budget-form">
                    <div class="form-group">
                        <label class="form-label">Budget mensuel global (‚Ç¨)</label>
                        <input type="number" id="global-budget-input" class="form-input" step="0.01" min="0" placeholder="Ex: 2000.00">
                        <p style="margin-top: 0.5rem; color: #71717a; font-size: 0.875rem;">
                            üí° Ce budget s'applique √† l'ensemble de vos d√©penses mensuelles. Laissez vide pour d√©sactiver le suivi global.
                        </p>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="hideEditGlobalBudget()">Annuler</button>
                        <button type="submit" class="btn-primary">Valider</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Statistiques et Analyses -->
        <section class="charts-section">
            <!-- Moyenne 3 derniers mois -->
            <div class="chart-card">
                <h3 class="chart-title">Moyenne des d√©penses</h3>
                <p class="chart-subtitle">Comparaison avec les 3 derniers mois</p>
                <div class="chart-container">
                    <canvas id="average-chart"></canvas>
                </div>
            </div>

            <!-- Budget vs R√©el -->
            <div class="chart-card">
                <h3 class="chart-title">Budget vs R√©alit√©</h3>
                <p class="chart-subtitle">√âvolution sur 3 mois</p>
                <div class="chart-container">
                    <canvas id="budget-vs-real-chart"></canvas>
                </div>
            </div>
        </section>

        <!-- Lien rapide vers cat√©gories -->
        <section class="top5-section">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <div>
                    <h3 class="section-title">Budgets par cat√©gorie</h3>
                    <p class="section-subtitle">G√©rez les budgets individuels de vos cat√©gories</p>
                </div>
                <a href="categories.html" class="btn-primary">
                    <span>üè∑Ô∏è</span>
                    <span>G√©rer les cat√©gories</span>
                </a>
            </div>
            
            <div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 12px; padding: 2rem; text-align: center;">
                <p style="color: #a1a1aa; font-size: 1rem; margin-bottom: 1rem;">
                    Pour d√©finir ou modifier les budgets de vos cat√©gories (Alimentation, Transport, etc.),<br>
                    rendez-vous sur la page <strong style="color: #e4e4e7;">Cat√©gories</strong>.
                </p>
                <a href="categories.html" class="btn-primary" style="display: inline-flex;">
                    Acc√©der aux cat√©gories ‚Üí
                </a>
            </div>
        </section>
    </main>

    <!-- Scripts -->
    <script src="js/api.js"></script>
    <script src="js/budget.js"></script>
</body>
</html>